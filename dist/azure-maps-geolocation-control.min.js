/* MIT License - Copyright (c) Microsoft Corporation. */


!function(t,l){"use strict";var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(t,o)};var s=function(){return(s=Object.assign||function(t){for(var o,e=1,a=arguments.length;e<a;e++)for(var i in o=arguments[e])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)};function o(t,s,r,l){return new(r=r||Promise)(function(e,o){function a(t){try{n(l.next(t))}catch(t){o(t)}}function i(t){try{n(l.throw(t))}catch(t){o(t)}}function n(t){var o;t.done?e(t.value):((o=t.value)instanceof r?o:new r(function(t){t(o)})).then(a,i)}n((l=l.apply(t,s||[])).next())})}function a(e,a){var i,n,s,t,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function o(o){return function(t){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=2&o[0]?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=0<(s=r.trys).length&&s[s.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=a.call(e,r)}catch(t){o=[6,t],n=0}finally{i=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,t])}}}var i=(n.merge=function(t,o){for(var e=window||global,a=0,i=t.split(".");a<i.length;a++){var n=i[a];if(!e[n])return o;e=e[n]}return s(s({},e),o)},n);function n(){}var p,r,c,u=(p=l.internal.EventEmitter,e(r=m,c=p),r.prototype=null===c?Object.create(c):(h.prototype=c.prototype,new h),m.prototype.dispose=function(){var o=this;this._map&&this._map.controls.remove(this),Object.keys(this).forEach(function(t){o[t]=null})},m.prototype.getLastKnownPosition=function(){return JSON.parse(JSON.stringify(this._lastKnownPosition))},m.prototype.onAdd=function(t,o){var e=this,a=(this._map=t).getMapContainer().classList;a.contains("high-contrast-dark")?this._hclStyle="dark":a.contains("high-contrast-light")&&(this._hclStyle="light"),this._resource=this._getTranslations(this._map.getStyle().language);var i=m,n=i._iconTemplate.replace("{color}","Gray"),s=i._iconTemplate.replace("{color}","DeepSkyBlue"),r=i._gpsBtnCss.replace(/{grayIcon}/g,n).replace(/{blueIcon}/g,s),l=document.createElement("style");l.innerHTML=r,document.body.appendChild(l);var p=document.createElement("div");p.classList.add("azure-maps-control-container"),p.setAttribute("aria-label",this._resource[0]),p.style.flexDirection="column",this._container.style.display="none",this._container=p;var c=document.createElement("button");return c.classList.add("azmaps-map-gpsBtn"),c.classList.add("azmaps-map-gpsDisabled"),c.setAttribute("title",this._resource[0]),c.setAttribute("alt",this._resource[0]),c.setAttribute("type","button"),c.addEventListener("click",this._toggleBtn),this._button=c,this._updateState(),this.setOptions(this._options),p.appendChild(c),i.isSupported().then(function(t){t?e._container.style.display="":e._invokeEvent("geolocationerror",{code:2,message:"Geolocation API not supported by device.",PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3})}),this._map.events.add("movestart",this._mapMoveStarted),this.setOptions(this._options),this._container},m.prototype.onRemove=function(){this._container&&this._container.remove(),"auto"===this._options.style&&this._map.events.remove("styledata",this._mapStyleChanged),this._map.events.remove("movestart",this._mapMoveStarted),void 0!==this._watchId&&navigator.geolocation.clearWatch(this._watchId),this._gpsMarker&&this._map.markers.remove(this._gpsMarker),this._map=null},m.prototype.getOptions=function(){return Object.assign({},this._options)},m.prototype.setOptions=function(t){if(t){var o="white";if(this._hclStyle)"dark"===this._hclStyle&&(o=this._darkColor);else switch("auto"===this._options.style&&this._map.events.remove("styledata",this._mapStyleChanged),this._options.style=t.style,t.style){case"dark":o=this._darkColor;break;case"auto":this._map.events.add("styledata",this._mapStyleChanged),o=this._getColorFromMapStyle()}if(this._button.style.backgroundColor=o,t.markerColor&&(this._options.markerColor=t.markerColor,this._gpsMarker&&this._gpsMarker.setOptions({color:t.markerColor})),"number"==typeof t.maxZoom&&(this._options.maxZoom=Math.min(Math.max(t.maxZoom,0),24)),"boolean"==typeof t.calculateMissingValues&&(this._options.calculateMissingValues=t.calculateMissingValues),"boolean"==typeof t.updateMapCamera&&(this._options.updateMapCamera=t.updateMapCamera,this._updateMapCamera=t.updateMapCamera),"boolean"==typeof t.showUserLocation&&(this._options.showUserLocation=t.showUserLocation,this._gpsMarker?this._gpsMarker.setOptions({visible:this._isActive&&this._options.showUserLocation}):this._lastKnownPosition&&this._onGpsSuccess()),"boolean"==typeof t.trackUserLocation&&(this._options.trackUserLocation=t.trackUserLocation),t.positionOptions){var e={};t.positionOptions.enableHighAccuracy&&(e.enableHighAccuracy=t.positionOptions.enableHighAccuracy),"number"==typeof t.positionOptions.maximumAge&&(e.maximumAge=t.positionOptions.maximumAge),"number"==typeof t.positionOptions.timeout&&(e.timeout=t.positionOptions.timeout),0<Object.keys(e).length&&(this._options.positionOptions=Object.assign(this._options.positionOptions,e),this._stopTracking(),this._updateState())}}},m.prototype.toggle=function(t){this._isActive="boolean"==typeof t?t:!this._isActive,this._isActive&&this._options.trackUserLocation&&this._lastKnownPosition&&this._onGpsSuccess(),this._updateMapCamera=this._options.updateMapCamera,this._updateState()},m.isSupported=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return window.navigator.permissions?[4,window.navigator.permissions.query({name:"geolocation"})]:[3,2];case 1:return[2,"denied"!==t.sent().state];case 2:return[2,!!window.navigator.geolocation]}})})},m.prototype._getColorFromMapStyle=function(){return-1<["satellite","satellite_road_labels","grayscale_dark","night"].indexOf(this._map.getStyle().style)?this._darkColor:"white"},m.prototype._stopTracking=function(){"number"==typeof this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=null)},m.prototype._updateState=function(){this._isActive&&!this._options.trackUserLocation||this._stopTracking(),this._gpsMarker&&this._gpsMarker.setOptions({visible:this._isActive&&this._options.showUserLocation});var t=this._resource[2],o="azmaps-map-gpsEnabled",e="azmaps-map-gpsDisabled";this._isActive?(o="azmaps-map-gpsDisabled",e="azmaps-map-gpsEnabled",this._options.trackUserLocation?("number"!=typeof this._watchId&&(this._watchId=navigator.geolocation.watchPosition(this._onGpsSuccess,this._onGpsError,this._options.positionOptions)),t=this._resource[1]):navigator.geolocation.getCurrentPosition(this._onGpsSuccess,this._onGpsError,this._options.positionOptions)):this._options.trackUserLocation&&(t=this._resource[0]),this._button.setAttribute("title",t),this._button.setAttribute("alt",t),this._button.classList.remove(o),this._button.classList.add(e)},m.prototype._getMarkerIcon=function(){var t=m._gpsDotIcon,o=this._lastKnownPosition.properties.heading;if(this._options.trackUserLocation&&null!==o&&!isNaN(o)){var e="-webkit-transform:rotate("+(o=Math.round(o))+"deg);transform:rotate("+o+"deg)";t=m._gpsArrowIcon.replace("{transform}",e)}return t},m.prototype._getTranslations=function(t){t&&0<t.indexOf("-")&&(t=t.substring(0,t.indexOf("-")));var o=m._translations,e=o[t];return e=e||o.en},m._gpsArrowIcon='<div style="{transform}"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="white" fill="{color}"/></g></svg></div>',m._gpsDotIcon='<div class="azmaps-map-gpsPulseIcon" style="background-color:{color}"></div>',m._iconTemplate="data:image/svg+xml;utf8,<svg version='1.1' xmlns='http://www.w3.org/2000/svg' x='0' y='0' viewBox='0 0 561 561' xml:space='preserve'><g fill='{color}'><path d='M280.5,178.5c-56.1,0-102,45.9-102,102c0,56.1,45.9,102,102,102c56.1,0,102-45.9,102-102C382.5,224.4,336.6,178.5,280.5,178.5z M507.45,255C494.7,147.9,410.55,63.75,306,53.55V0h-51v53.55C147.9,63.75,63.75,147.9,53.55,255H0v51h53.55C66.3,413.1,150.45,497.25,255,507.45V561h51v-53.55C413.1,494.7,497.25,410.55,507.45,306H561v-51H507.45z M280.5,459C181.05,459,102,379.95,102,280.5S181.05,102,280.5,102S459,181.05,459,280.5S379.95,459,280.5,459z'/></g></svg>",m._gpsBtnCss='.azmaps-map-gpsBtn{margin:0;padding:0;border:none;border-collapse:collapse;width:32px;height:32px;text-align:center;cursor:pointer;line-height:32px;background-repeat:no-repeat;background-size:20px;background-position:center center;z-index:200;box-shadow:0px 0px 4px rgba(0,0,0,0.16);}.azmaps-map-gpsDisabled{background-image:url("{grayIcon}");}.azmaps-map-gpsDisabled:hover{background-image:url("{blueIcon}");filter:brightness(90%);}.azmaps-map-gpsEnabled{background-image:url("{blueIcon}");}.azmaps-map-gpsEnabled:hover{background-image:url("{blueIcon}");filter:brightness(90%);}.azmaps-map-gpsPulseIcon{display:block;width:15px;height:15px;border-radius:50%;background:orange;border:2px solid white;cursor:pointer;box-shadow:0 0 0 rgba(0, 204, 255, 0.6);animation:pulse 2s infinite;}@keyframes pulse {0% {box-shadow:0 0 0 0 rgba(0, 204, 255, 0.6);}70% {box-shadow:0 0 0 20px rgba(0, 204, 255, 0);}100% {box-shadow:0 0 0 0 rgba(0, 204, 255, 0);}}',m._translations={af:["begin dop","stop die dop","my plek","ligginggewing beheer"],ar:["بدء تتبع","تتبع توقف","موقعي","السيطرة تحديد الموقع الجغرافي"],eu:["Hasi segimendua","Stop jarraipena","Nire kokapena","Geokokapen kontrol"],bg:["Започнете да проследявате","Спиране на проследяването","Моето място","контрол за геолокация"],zh:["开始跟踪","停止追踪","我的位置","地理位置控制"],hr:["Započnite praćenje","zaustavljanje praćenje","Moja lokacija","kontrola Geolocation"],cs:["začít sledovat","Zastavit sledování","Moje lokace","ovládání Geolocation"],da:["Start sporing","Stop sporing","min placering","Geolocation kontrol"],nl:["beginnen met het bijhouden","stop volgen","Mijn locatie","Geolocation controle"],et:["Alusta jälgimist","Stopp jälgimise","Minu asukoht","Geolocation kontrolli"],fi:["Aloita seuranta","Lopeta seuranta","Minun sijaintini","Geolocation ohjaus"],fr:["Démarrer le suivi","suivi d'arrêt","Ma position","le contrôle de géolocalisation"],gl:["comezar a controlar","seguimento parada","A miña localización","control de xeolocalización"],de:["starten Sie Tracking","Stop-Tracking","Mein Standort","Geolokalisierung Steuer"],el:["Ξεκινήστε την παρακολούθηση","Διακοπή παρακολούθησης","Η τοποθεσία μου","ελέγχου geolocation"],hi:["ट्रैक करना शुरू","बंद करो ट्रैकिंग","मेरा स्थान","जियोलोकेशन नियंत्रण"],hu:["követés indítása","követés leállítása","Saját hely","Geolocation ellenőrzés"],id:["Mulai pelacakan","berhenti pelacakan","Lokasi saya","kontrol geolocation"],it:["Inizia il monitoraggio","monitoraggio arresto","La mia posizione","controllo geolocalizzazione"],ja:["追跡を開始","追跡を停止","私の場所","ジオロケーション制御"],kk:["қадағалау бастау","қадағалау тоқтату","Менің орналасуы","геоорын бақылау"],ko:["추적 시작","정지 추적","내 위치","위치 정보 제어"],es:["iniciar el seguimiento","Detener el seguimiento","Mi ubicacion","control de geolocalización"],lv:["Sākt izsekošana","Stop izsekošana","Mana atrašanās vieta","Geolocation kontrole"],lt:["pradėti stebėti","Sustabdyti sekimo","Mano vieta","Geografinė padėtis kontrolė"],ms:["mula menjejaki","Stop pengesanan","Lokasi saya","kawalan geolokasi"],nb:["begynne å spore","stopp sporing","Min posisjon","geolocation kontroll"],pl:["rozpocząć śledzenie","Zatrzymaj śledzenie","Moja lokacja","kontrola Geolokalizacja"],pt:["começar a controlar","rastreamento parada","Minha localização","controle de geolocalização"],ro:["Pornire urmărire","Oprire urmărire","Locatia mea","controlul de geolocalizare"],ru:["Начать отслеживание","остановка отслеживания","Мое местонахождение","контроль геолокации"],sr:["Старт трацкинг","стоп праћење","Моја локација","kontrola геолоцатион"],sk:["začať sledovať","zastaviť sledovanie","moja poloha","ovládanie Geolocation"],sl:["Začni sledenje","Stop za sledenje","moja lokacija","nadzor Geolocation"],sv:["börja spåra","Stoppa spårning","Min plats","geolocation kontroll"],th:["เริ่มการติดตาม","ติดตามหยุด","ตำแหน่งของฉัน","ควบคุม Geolocation"],tr:["izlemeyi başlat","Dur izleme","Benim konumum","Coğrafi Konum kontrolü"],uk:["почати відстеження","зупинка відстеження","моє місце розташування","контроль геолокації"],vi:["Bắt đầu theo dõi","dừng theo dõi","vị trí của tôi","kiểm soát định vị"],en:["Start tracking","Stop tracking","My location","Geolocation control"]},m);function h(){this.constructor=r}function m(t){var r=p.call(this)||this;return r._options={style:"light",positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},showUserLocation:!0,trackUserLocation:!1,markerColor:"DodgerBlue",maxZoom:15,calculateMissingValues:!1,updateMapCamera:!0},r._darkColor="#011c2c",r._hclStyle=null,r._isActive=!1,r._updateMapCamera=!0,r._toggleBtn=function(){r.toggle()},r._mapStyleChanged=function(){r._button&&!r._hclStyle&&(r._button.style.backgroundColor=r._getColorFromMapStyle())},r._mapMoveStarted=function(){r._updateMapCamera=!1},r._onGpsSuccess=function(t){var o;if(t){o=[t.coords.longitude,t.coords.latitude];var e={timestamp:new Date(t.timestamp),_timestamp:t.timestamp};if(Object.assign(e,t.coords),r._options.calculateMissingValues&&r._lastKnownPosition){if("number"!=typeof t.coords.speed){var a=t.timestamp-r._lastKnownPosition.properties._timestamp,i=l.math.getDistanceTo(r._lastKnownPosition.geometry.coordinates,o);e.speed=i/(.001*a)}"number"!=typeof t.coords.heading&&(e.heading=l.math.getHeading(r._lastKnownPosition.geometry.coordinates,o))}r._lastKnownPosition=new l.data.Feature(new l.data.Point(o),e)}if(r._lastKnownPosition){if(o=o||r._lastKnownPosition.geometry.coordinates,r._isActive){var n=r._getMarkerIcon();if(r._options.showUserLocation?r._gpsMarker?r._gpsMarker.setOptions({position:o,htmlContent:n,visible:r._isActive&&r._options.showUserLocation}):(r._gpsMarker=new l.HtmlMarker({position:o,htmlContent:n,color:r._options.markerColor}),r._map.markers.add(r._gpsMarker)):r._gpsMarker.setOptions({visible:!1}),r._updateMapCamera){var s={center:o};r._map.getCamera().zoom<15&&(s.zoom=15),r._map.setCamera(s)}}r._invokeEvent("geolocationsuccess",r._lastKnownPosition)}},r._onGpsError=function(t){r._watchId=null,r._isActive=!1,r._updateState(),r._invokeEvent("geolocationerror",t)},t&&(t.positionOptions&&(r._options.positionOptions=Object.assign(r._options.positionOptions,t.positionOptions)),t.style&&(r._options.style=t.style),t.markerColor&&(r._options.markerColor=t.markerColor),"boolean"==typeof t.showUserLocation&&(r._options.showUserLocation=t.showUserLocation),"boolean"==typeof t.trackUserLocation&&(r._options.trackUserLocation=t.trackUserLocation),"number"==typeof t.maxZoom&&(r._options.maxZoom=Math.min(Math.max(t.maxZoom,0),24)),"boolean"==typeof t.calculateMissingValues&&(r._options.calculateMissingValues=t.calculateMissingValues),"boolean"==typeof t.updateMapCamera&&(r._options.updateMapCamera=t.updateMapCamera,r._updateMapCamera=t.updateMapCamera)),r}var g=Object.freeze({__proto__:null,GeolocationControl:u}),d=i.merge("atlas.control",g);t.control=d}(this.atlas=this.atlas||{},atlas);
